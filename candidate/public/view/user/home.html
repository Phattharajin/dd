<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/public/img/icon_logo.png" type="image/x-icon">
    <title>Home</title>
    <link href="/public/css/bootstrap.min.css" rel="stylesheet">
    <script src="/public/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="/public/css/card.css">
    <link rel="stylesheet" href="/public/css/detail.css">
    <script src="/public/js/header.js"></script>
</head>

<body>
    <div class="slider-container">
        <div class="slider-background">
            <img src="/public/img/mfu.jpg" alt="Image 1">
            <div class="content">
                <h1><a href="#">Student Organization Election Mae Fah Luang University for the year 2022</a></h1>
            </div>
        </div>
        <div class="slider-background">
            <img src="/public/img/mfu4.jpg" alt="Image 2">
            <div class="content" >
                <h1><a href="#">Election Results of Student Council</a></h1>
            </div>
        </div>
        <div class="slider-background">
            <img src="/public/img/mfu3.jpg" alt="Image 3">
            <div class="content">
                <h1><a href="#">Election Results of Student Union President</a></h1>
            </div>
        </div>
        <div class="nav-arrow prev">&#8249;</div>
        <div class="nav-arrow next">&#8250;</div>
        <div class="dots">
            
        </div>

    </div>
    <div>
        <div class="card-container mt-5 pt-5">

            <a href="/PDPA_president" class="card president" id="president-card"
                style="display: none; text-align: center;">
                <div class="card-title"
                    style="display: flex; align-items: center; justify-content: center; height: 100%;">
                    President of the Student Union Candidate Register</div>
                <div class="text-end">
                    <div style="position: absolute; bottom: 10px; right: 10px;">
                        <i class="fas fa-list fa-2x"></i>
                    </div>
                </div>
            </a>

            <a href="/PDPA_council_school" class="card councilschool" id="council-school-card"
                style="display: none; text-align: center;">
                <div class="card-title"
                    style="display: flex; align-items: center; justify-content: center; height: 100%;">
                    Student Council Member (School of Study) Register</div>
                <div class="text-end">
                    <div style="position: absolute; bottom: 10px; right: 10px;">
                        <i class="fas fa-list fa-2x"></i>
                    </div>
                </div>
            </a>

            <a href="/PDPA_council_normal" class="card councilnormal" id="council-normal-card"
                style="display: none; text-align: center;">
                <div class="card-title"
                    style="display: flex; align-items: center; justify-content: center; height: 100%;">
                    Student Council Member (Normal) Register</div>
                <div class="text-end">
                    <div style="position: absolute; bottom: 10px; right: 10px;">
                        <i class="fas fa-list fa-2x"></i>
                    </div>
                </div>
            </a>

            <a href="/information_president_student" class="card president" id="president-info-card"
                style="display: none; text-align: center;">
                <div class="card-title"
                    style="display: flex; align-items: center; justify-content: center; height: 100%;">
                    President of the Student Union Candidate Information</div>
                <div class="text-end">
                    <div style="position: absolute; bottom: 10px; right: 10px;">
                        <i class="fas fa-pen fa-2x"></i>
                    </div>
                </div>
            </a>

            <a href="/information_council_school" class="card councilschool" id="council-school-info-card"
                style="display: none; text-align: center;">
                <div class="card-title"
                    style="display: flex; align-items: center; justify-content: center; height: 100%;">
                    Student Council Member (School of Study) Information</div>
                <div class="text-end">
                    <div style="position: absolute; bottom: 10px; right: 10px;">
                        <i class="fas fa-pen fa-2x"></i>
                    </div>
                </div>
            </a>

            <a href="/information_council_normal" class="card councilnormal" id="council-normal-info-card"
                style="display: none; text-align: center;">
                <div class="card-title"
                    style="display: flex; align-items: center; justify-content: center; height: 100%;">
                    Student Council Member (Normal) Information</div>
                <div class="text-end">
                    <div style="position: absolute; bottom: 10px; right: 10px;">
                        <i class="fas fa-pen fa-2x"></i>
                    </div>
                </div>
            </a>

            <a href="/information_president_faculty" class="card faculty" id="faculty-info-card"
                style="display: none; text-align: center;">
                <div class="card-title"
                    style="display: flex; align-items: center; justify-content: center; height: 100%;">
                    President of Student Association Information
                </div>
                <div class="text-end">
                    <div style="position: absolute; bottom: 10px; right: 10px;">
                        <i class="fas fa-pen fa-2x"></i>
                    </div>
                </div>
            </a>

            <a href="/vote_president_student" class="card president" id="vote-president-card"
                style="display: none; text-align: center;">
                <div class="card-title"
                    style="display: flex; align-items: center; justify-content: center; height: 100%;">
                    President of the Student Union Candidate Vote</div>
                <div class="text-end">
                    <div style="position: absolute; bottom: 10px; right: 10px;">
                        <i class="fas fa-file-alt"></i>
                    </div>
                </div>
            </a>

            <a href="vote_council_school" class="card councilschool" id="vote-council-school-card"
                style="display: none; text-align: center;">
                <div class="card-title"
                    style="display: flex; align-items: center; justify-content: center; height: 100%;">Student Council
                    Member (School of Study) Vote</div>
                <div class="text-end">
                    <div style="position: absolute; bottom: 10px; right: 10px;">
                        <i class="fas fa-file-alt fa-2x"></i>
                    </div>
                </div>
            </a>

            <a href="vote_council_normal" class="card councilnormal" id="vote-council-normal-card"
                style="display: none; text-align: center;">
                <div class="card-title"
                    style="display: flex; align-items: center; justify-content: center; height: 100%;">Student Council
                    Member (Normal) Vote</div>
                <div class="text-end">
                    <div style="position: absolute; bottom: 10px; right: 10px;">
                        <i class="fas fa-file-alt fa-2x"></i>
                    </div>
                </div>
            </a>

            <a href="vote_president_faculty" class="card faculty" id="vote-faculty-card"
                style="display: none; text-align: center;">
                <div class="card-title"
                    style="display: flex; align-items: center; justify-content: center; height: 100%;">President of Student Association Vote</div>
                <div class="text-end">
                    <div style="position: absolute; bottom: 10px; right: 10px;">
                        <i class="fas fa-file-alt fa-2x"></i>
                    </div>
                </div>
            </a>

            <a href="result_president_student" class="card president" id="result_president_student"
                style="display: none; text-align: center;">
                <div class="card-title"
                    style="display: flex; align-items: center; justify-content: center; height: 100%;">President of the
                    Student Union Candidate Result</div>
                <div class="text-end">
                    <div style="position: absolute; bottom: 10px; right: 10px;">
                        <i class="fa fa-poll-h fa-2x"></i>
                    </div>
                </div>
            </a>

            <a href="result_council_school" class="card councilschool" id="council-school-result-card"
                style="display: none; text-align: center;">
                <div class="card-title"
                    style="display: flex; align-items: center; justify-content: center; height: 100%;">Student Council
                    Member (School of Study) Result</div>
                <div class="text-end">
                    <div style="position: absolute; bottom: 10px; right: 10px;">
                        <i class="fa fa-poll-h fa-2x"></i>
                    </div>
                </div>
            </a>

            <a href="result_council_normal" class="card councilnormal" id="council-normal-result-card"
                style="display: none; text-align: center;">
                <div class="card-title"
                    style="display: flex; align-items: center; justify-content: center; height: 100%;">Student Council
                    Member (Normal) Result</div>
                <div class="text-end">
                    <div style="position: absolute; bottom: 10px; right: 10px;">
                        <i class="fa fa-poll-h fa-2x"></i>
                    </div>
                </div>
            </a>

            <a href="result_president_faculty" class="card faculty" id="faculty-result-card"
                style="display: none; text-align: center;">
                <div class="card-title"
                    style="display: flex; align-items: center; justify-content: center; height: 100%;">President of Student Association Result</div>
                <div class="text-end">
                    <div style="position: absolute; bottom: 10px; right: 10px;">
                        <i class="fa fa-poll-h fa-2x"></i>
                    </div>
                </div>
            </a>

        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            fetch("/active-events")
                .then(response => response.json())
                .then(events => {
                    console.log("Received Events:", events);  // Log events to check if they're received correctly

                    // Define the mapping of events to card IDs
                    const eventCardMap = {
                        "President of the Student Union Candidate Register": "#president-card",
                        "Student Council Member (School of Study) Register": "#council-school-card",
                        "Student Council Member (Normal) Register": "#council-normal-card",
                        "President of the Student Union Candidate Information": "#president-info-card",
                        "Student Council Member (School of Study) Information": "#council-school-info-card",
                        "Student Council Member (Normal) Information": "#council-normal-info-card",
                        "President of Student Association Information": "#faculty-info-card",
                        "President of the Student Union Candidate Vote": "#vote-president-card",
                        "Student Council Member (School of Study) Vote": "#vote-council-school-card",
                        "Student Council Member (Normal) Vote": "#vote-council-normal-card",
                        "President of Student Association Vote": "#vote-faculty-card",
                        "President of the Student Union Candidate Result": "#president-result-card",
                        "Student Council Member (School of Study) Result": "#council-school-result-card",
                        "Student Council Member (Normal) Result": "#council-normal-result-card",
                        "President of Student Association Result": "#faculty-result-card"
                    };

                    events.forEach(event => {
                        console.log("Event:", event);  // Log each event to verify
                        const cardId = eventCardMap[event];  // Get the card ID based on the event type
                        if (cardId) {
                            const card = document.querySelector(cardId);  // Find the card element
                            if (card) {
                                console.log(`Displaying card for: ${event}`);  // Log to ensure card is selected
                                card.style.display = "block";  // Show the card if the event is active
                            } else {
                                console.log(`Card not found for event: ${event}`);  // Log if card is not found
                            }
                        } else {
                            console.log(`No card mapped for event: ${event}`);  // Log if no card is mapped
                        }
                    });
                })
                .catch(error => {
                    console.error("Error fetching active events:", error);
                });
        });

        async function setFacultyCardColor() {
            try {
                const response = await fetch('/faculty');
                const data = await response.json();

                if (response.ok) {
                    const facultyCard = document.querySelector('.faculty');

                    if (!facultyCard) {
                        console.error("Element with class 'faculty' not found.");
                        return;
                    }

                    facultyCard.style.backgroundColor = data.schoolColor; // Apply background color

                    const textShouldBeBlack = ["#ffffff", "#fff004", "#fdeeb1"].includes(data.schoolColor.toLowerCase());

                    // Add or remove the "black-text" class to change text & icon color
                    if (textShouldBeBlack) {
                        facultyCard.classList.add("black-text");
                    } else {
                        facultyCard.classList.remove("black-text");
                    }

                    console.log(`Applied background: ${data.schoolColor}, Applied text color: ${textShouldBeBlack ? "black" : "white"}`);
                } else {
                    console.error("Failed to fetch school color");
                }
            } catch (error) {
                console.error("Error fetching school color:", error);
            }
        }

        // Call the function when the page loads
        document.addEventListener("DOMContentLoaded", setFacultyCardColor);


        let currentSlide = 0;
    
    document.addEventListener("DOMContentLoaded", fetchSlides);

    function fetchSlides() {
      fetch("http://localhost:3000/get-slides")
        .then(response => response.json())
        .then(data => {
          const slides = document.querySelectorAll(".slider-background");
          const dotsContainer = document.querySelector(".dots");

          for (let i = 0; i < 3; i++) {
            const slide = data[i];
            if (slide) {
              slides[i].querySelector("img").src = "http://localhost:3000" + slide.imagePath;

              const content = slides[i].querySelector(".content");
              content.innerHTML = `<h1><a href="${slide.linkDetail}" target="_blank">${slide.textDetail}</a></h1>`;
            }

            const dot = document.createElement('span');
            dot.className = 'dot';
            dot.addEventListener('click', () => showSlide(i));
            dotsContainer.appendChild(dot);
          }

          setupSlideNavigation();
          showSlide(0);
        })
        .catch(error => console.error("âŒ Error fetching slides:", error));
    }

    const showSlide = (index) => {
      const slides = document.querySelectorAll('.slider-background');
      const dots = document.querySelectorAll('.dot');
      slides.forEach((slide, i) => {
        slide.style.display = i === index ? 'block' : 'none';
        dots[i].classList.toggle('active', i === index);
      });
      currentSlide = index;
    };

    const showPrevSlide = () => {
      currentSlide = (currentSlide - 1 + 3) % 3;
      showSlide(currentSlide);
    };

    const showNextSlide = () => {
      currentSlide = (currentSlide + 1) % 3;
      showSlide(currentSlide);
    };

    function setupSlideNavigation() {
      const prevArrow = document.querySelector('.prev');
      const nextArrow = document.querySelector('.next');
      prevArrow.addEventListener('click', showPrevSlide);
      nextArrow.addEventListener('click', showNextSlide);
    }

    </script>
</body>

</html>